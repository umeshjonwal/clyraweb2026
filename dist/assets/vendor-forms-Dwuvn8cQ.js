import{r as e,R as t,C as r}from"./vendor-core-DLGFHdi_.js";var n=Object.defineProperty,o=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,a=(e,t,r)=>new Promise((n,o)=>{var i=e=>{try{a(r.next(e))}catch(t){o(t)}},s=e=>{try{a(r.throw(e))}catch(t){o(t)}},a=e=>e.done?n(e.value):Promise.resolve(e.value).then(i,s);a((r=r.apply(e,t)).next())}),l={};((e,t)=>{for(var r in t)n(e,r,{get:t[r],enumerable:!0})})(l,{SubmissionError:()=>g,appendExtraData:()=>C,createClient:()=>P,getDefaultClient:()=>A,isSubmissionError:()=>y});var c,d=(c=l,((e,t,r,a)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let l of i(t))!s.call(e,l)&&l!==r&&n(e,l,{get:()=>t[l],enumerable:!(a=o(t,l))||a.enumerable});return e})(n({},"__esModule",{value:!0}),c)),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/;var p=()=>navigator.webdriver||!!document.documentElement.getAttribute(function(e){if(e=String(e).replace(/[\t\n\f\r ]+/g,""),!f.test(e))throw new TypeError("Failed to execute 'atob' on 'Window': The string to be decoded is not correctly encoded.");e+="==".slice(2-(3&e.length));for(var t,r,n,o="",i=0;i<e.length;)t=u.indexOf(e.charAt(i++))<<18|u.indexOf(e.charAt(i++))<<12|(r=u.indexOf(e.charAt(i++)))<<6|(n=u.indexOf(e.charAt(i++))),o+=64===r?String.fromCharCode(t>>16&255):64===n?String.fromCharCode(t>>16&255,t>>8&255):String.fromCharCode(t>>16&255,t>>8&255,255&t);return o}("d2ViZHJpdmVy"))||!!window.callPhantom||!!window._phantom,m=class{constructor(){this.loadedAt=Date.now(),this.webdriver=p()}data(){return{loadedAt:this.loadedAt,webdriver:this.webdriver}}},E=class{constructor(e){this.kind="success",this.next=e.next}};var h=class{constructor(e,t){this.paymentIntentClientSecret=e,this.resubmitKey=t,this.kind="stripePluginPending"}};function y(e){return"error"===e.kind}var g=class{constructor(...e){var t;this.kind="error",this.formErrors=[],this.fieldErrors=new Map;for(let r of e){if(!r.field){this.formErrors.push({code:r.code&&_(r.code)?r.code:"UNSPECIFIED",message:r.message});continue}let e=null!=(t=this.fieldErrors.get(r.field))?t:[];e.push({code:r.code&&O(r.code)?r.code:"UNSPECIFIED",message:r.message}),this.fieldErrors.set(r.field,e)}}getFormErrors(){return[...this.formErrors]}getFieldErrors(e){var t;return null!=(t=this.fieldErrors.get(e))?t:[]}getAllFieldErrors(){return Array.from(this.fieldErrors)}};function _(e){return e in I}var I={BLOCKED:"BLOCKED",EMPTY:"EMPTY",FILES_TOO_BIG:"FILES_TOO_BIG",FORM_NOT_FOUND:"FORM_NOT_FOUND",INACTIVE:"INACTIVE",NO_FILE_UPLOADS:"NO_FILE_UPLOADS",PROJECT_NOT_FOUND:"PROJECT_NOT_FOUND",TOO_MANY_FILES:"TOO_MANY_FILES"};function O(e){return e in S}var S={REQUIRED_FIELD_EMPTY:"REQUIRED_FIELD_EMPTY",REQUIRED_FIELD_MISSING:"REQUIRED_FIELD_MISSING",STRIPE_CLIENT_ERROR:"STRIPE_CLIENT_ERROR",STRIPE_SCA_ERROR:"STRIPE_SCA_ERROR",TYPE_EMAIL:"TYPE_EMAIL",TYPE_NUMERIC:"TYPE_NUMERIC",TYPE_TEXT:"TYPE_TEXT"};var w=e=>function(e){for(var t,r,n,o,i="",s=0,a=(e=String(e)).length%3;s<e.length;){if((r=e.charCodeAt(s++))>255||(n=e.charCodeAt(s++))>255||(o=e.charCodeAt(s++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");i+=u.charAt((t=r<<16|n<<8|o)>>18&63)+u.charAt(t>>12&63)+u.charAt(t>>6&63)+u.charAt(63&t)}return a?i.slice(0,a-3)+"===".substring(a):i}(JSON.stringify(e)),T=e=>{let t="@formspree/core@4.0.0";return e?`${e} ${t}`:t};function C(e,t,r){e instanceof FormData?e.append(t,r):e[t]=r}var R=class{constructor(e={}){this.project=e.project,this.stripe=e.stripe,"undefined"!=typeof window&&(this.session=new m)}submitForm(e,t){return a(this,arguments,function*(e,t,r={}){let n=r.endpoint||"https://formspree.io",o=this.project?`${n}/p/${this.project}/f/${e}`:`${n}/f/${e}`,i={Accept:"application/json","Formspree-Client":T(r.clientName)};function s(e){return a(this,null,function*(){try{let t=yield(yield fetch(o,{method:"POST",mode:"cors",body:e instanceof FormData?e:JSON.stringify(e),headers:i})).json();if(function(e){return null!==e&&"object"==typeof e}(t)){if(function(e){return"errors"in e&&Array.isArray(e.errors)&&e.errors.every(e=>"string"==typeof e.message)||"error"in e&&"string"==typeof e.error}(t))return Array.isArray(t.errors)?new g(...t.errors):new g({message:t.error});if(function(e){if("stripe"in e&&"resubmitKey"in e&&"string"==typeof e.resubmitKey){let{stripe:t}=e;return"object"==typeof t&&null!=t&&"paymentIntentClientSecret"in t&&"string"==typeof t.paymentIntentClientSecret}return!1}(t))return new h(t.stripe.paymentIntentClientSecret,t.resubmitKey);if(function(e){return"next"in e&&"string"==typeof e.next}(t))return new E({next:t.next})}return new g({message:"Unexpected response format"})}catch(t){let e=t instanceof Error?t.message:`Unknown error while posting to Formspree: ${JSON.stringify(t)}`;return new g({message:e})}})}if(this.session&&(i["Formspree-Session-Data"]=w(this.session.data())),t instanceof FormData||(i["Content-Type"]="application/json"),this.stripe&&r.createPaymentMethod){let e=yield r.createPaymentMethod();if(e.error)return new g({code:"STRIPE_CLIENT_ERROR",field:"paymentMethod",message:"Error creating payment method"});C(t,"paymentMethod",e.paymentMethod.id);let n=yield s(t);if("error"===n.kind)return n;if("stripePluginPending"===n.kind){let e=yield this.stripe.handleCardAction(n.paymentIntentClientSecret);if(e.error)return new g({code:"STRIPE_CLIENT_ERROR",field:"paymentMethod",message:"Stripe SCA error"});t instanceof FormData?t.delete("paymentMethod"):delete t.paymentMethod,C(t,"paymentIntent",e.paymentIntent.id),C(t,"resubmitKey",n.resubmitKey);let r=yield s(t);return b(r),r}return n}let l=yield s(t);return b(l),l})}};function b(e){let{kind:t}=e;if("success"!==t&&"error"!==t)throw new Error(`Unexpected submission result (kind: ${t})`)}var F,P=e=>new R(e),A=()=>(F||(F=P()),F);function D(e){let{prefix:r,field:n,errors:o,...i}=e;if(null==o)return null;let s=n?o.getFieldErrors(n):o.getFormErrors();return 0===s.length?null:t.createElement("div",{...i},r?`${r} `:null,s.map(e=>e.message).join(", "))}var v=e.createContext({elements:null});var N=t.createContext(null);function M(t,n={}){let o=e.useContext(N)??{client:d.getDefaultClient()},{client:i=o.client,extraData:s,origin:a}=n,{elements:l}=e.useContext(v),{stripe:c}=i;return async function(e){let n=function(e){return"preventDefault"in e&&"function"==typeof e.preventDefault}(e)?function(e){e.preventDefault();let t=e.currentTarget;if("FORM"!=t.tagName)throw new Error("submit was triggered for a non-form element");return new FormData(t)}(e):e;if("object"==typeof s)for(let[t,r]of Object.entries(s)){let e;e="function"==typeof r?await r():r,void 0!==e&&d.appendExtraData(n,t,e)}let o=null==l?void 0:l.getElement(r),u=c&&o?()=>c.createPaymentMethod({type:"card",card:o,billing_details:x(n)}):void 0;return i.submitForm(t,n,{endpoint:a,clientName:"@formspree/react@3.0.0",createPaymentMethod:u})}}function x(e){let t={address:L(e)};for(let r of["name","email","phone"]){let n=e instanceof FormData?e.get(r):e[r];n&&"string"==typeof n&&(t[r]=n)}return t}function L(e){let t={};for(let[r,n]of[["address_line1","line1"],["address_line2","line2"],["address_city","city"],["address_country","country"],["address_state","state"],["address_postal_code","postal_code"]]){let o=e instanceof FormData?e.get(r):e[r];o&&"string"==typeof o&&(t[n]=o)}return t}function j(t,r={}){let[n,o]=e.useState(null),[i,s]=e.useState(null),[a,l]=e.useState(!1),[c,u]=e.useState(!1),f=M(t,{client:r.client,extraData:r.data,origin:r.endpoint});return[{errors:n,result:i,submitting:a,succeeded:c},async function(e){l(!0);let t=await f(e);l(!1),d.isSubmissionError(t)?(o(t),u(!1)):(o(null),s(t),u(!0))},function(){o(null),s(null),l(!1),u(!1)}]}export{j as J,D as V};
